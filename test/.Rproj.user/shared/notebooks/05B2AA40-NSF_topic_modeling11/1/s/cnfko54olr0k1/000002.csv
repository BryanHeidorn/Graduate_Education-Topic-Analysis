"0","library(styler)"
"0",""
"0","#### Functions #####"
"0",""
"0","#--------------------"
"0","readpercent <- function()"
"0","{ "
"0","  n <- readline(prompt=""Enter a percent, positive number selects head & negative selects tail[-100-100]: "")"
"0","  if(!(grepl(""^-?[0-9]+$"",n)) || as.integer(n) > 100 || as.integer(n) < -100) #"
"0","  {"
"0","    return(readpercent())"
"0","  }"
"0","  return(as.integer(n))"
"0","}"
"0",""
"0","#--------------------"
"0","HistogramFun<-function(funding, fstatedPercent, numRows) {"
"0","  cat(""typeof funding"",typeof(funding), ""typeof nrows"", typeof(numRows), ""nrows funding "", typeof(numRows), ""numRows::"", numRows, ""\n"")"
"0","  if (fstatedPercent < 0) {"
"0","    color1 <- ""gray""; "
"0","    color2 <- ""gray40"";"
"0","    nInHead <- as.integer(((100 + fstatedPercent)/100) * numRows)"
"0","    nInTail <- numRows - nInHead"
"0","    headPercent <- fstatedPercent + 100"
"0","    tailPercent <- abs(fstatedPercent)"
"0","  } else {"
"0","    color2 <- ""gray"""
"0","    color1 <- ""gray40"""
"0","    nInHead <- as.integer((fstatedPercent/100) * numRows)"
"0","    nInTail <- numRows - nInHead"
"0","    headPercent <- fstatedPercent"
"0","    tailPercent <- 100 - fstatedPercent"
"0","  }"
"0","  cols = c(rep(color1, times = nInHead), rep(color2, times = nInTail))"
"0","  #ylim= c(0, 3),  "
"0","  barplot(funding, col = cols, border=cols, main = NULL, "
"0","          xpd = FALSE, las=1"
"0","  )"
"0","  "
"0","  #legend(""right"", legend = c(""Head (10%)"", ""Long Tail (90%)""), fill = c(""gray40"", ""gray""), cex=.9)"
"0","  legend(""right"", "
"0","         legend = c(paste(""Head ("", headPercent, ""%)"", sep = """"), "
"0","                    paste(""Tail ("", tailPercent, ""%)"", sep = """")), "
"0","         fill = c(color1, color2), cex=.9)"
"0","  title(""The focus for later analysis is shaded dark"", cex.main=.95, line= -2) "
"0","  title(xlab=""Size Ordered Grants - bar for each grant"", line=0)"
"0","  title(ylab=""Dollar Value of Award in Millions"", line = 2) "
"0","}"
