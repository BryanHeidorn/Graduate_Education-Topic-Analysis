"0","#Top documents per topic"
"0","library(ggplot2)"
"0","library(ggrepel)"
"0",""
"0","number_of_documents = 5 #number of top docs to view"
"0","title <- paste(""LDA Top Documents for"", NumTopics, ""Topics"")"
"0",""
"0","top_documents <- lda_gamma %>%"
"0","  group_by(topic) %>%"
"0","  arrange(topic, desc(gamma)) %>%"
"0","  slice(seq_len(number_of_documents)) %>%"
"0","  arrange(topic, gamma) %>%"
"0","  mutate(row = row_number()) %>%"
"0","  ungroup() #%>%"
"0","  #re-label topics"
"0","  #mutate(topic = paste(""Topic"", topic, sep = "" ""))"
"0",""
"0","#topicFileName <- gsub("".csv"",""top_documents.csv"", filename)"
"0","write.csv(top_documents, paste(topicDir,""/top_documents.csv"", sep=""""))"
"0",""
"0","top_bigrams_for_docs <- bigram_tf_idf %>%"
"0","  group_by(id) %>%"
"0","  arrange(id, desc(tf_idf)) %>%"
"0","  slice(seq_len(number_of_documents)) %>%"
"0","  arrange(id, tf_idf) %>%"
"0","  ungroup()  %>%"
"0","  select(id, bigram) "
"0"," "
"0","# make the 5 bigrams into 5 columns"
"0","top_bigrams_for_docs_wide <- "
"0","  dcast(setDT(top_bigrams_for_docs), id~rowid(id, prefix=""bigram""), value.var=""bigram"")   "
"0",""
"0","# add the bigram columns to top_docs"
"0","### error - repeats of bigrams for too many documents...."
"0","# maybe not an error... documents in the smae topic are getting many of the same bigrams."
"0","top_documents <- left_join(top_documents, top_bigrams_for_docs_wide,"
"0","            select(bigram1, bigram2, bigram3, bigram4, bigram5),"
"0","            by = c(""document"" = ""id""))"
"0",""
"0",""
